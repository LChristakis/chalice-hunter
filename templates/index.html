{% extends "layout.html" %}
{% block body %}

	<header class="container">
		<h1 class="m--1">Chalice Seeker</h1>
	</header>
	<div class="g--10 m--1 container container--wrap--s">
		<div class="card g--4 g-m--12 g-s--12 g-t--12 nudge--right no-nudge--s no-nudge--t">
			<input type="text" required placeholder="Chalice" class="search chalice-search"></input>
		</div>
		<div class="card g--4 g-m--12 g-s--12 g-t--12 nudge--right no-nudge--s no-nudge--t">
			<input type="text" required placeholder="Weapon" class="search weapon-search">
		</div>
		<div class="card g--4 g-m--12 g-s--12 g-t--12">
			<input type="text" required placeholder="Material" class="search material-search">
		</div>
	</div>
	<div class="g--2 g-m--2 g-s--12 g-t--12 m--5 m-m--5">
		<button class="search reset btn--raised btn--primary">RESET</button>
	</div>
	{% for row in data %}
		<div class="chalice-entry tile g--12">
			<table class="g--12">
				<tr>
					<td><h5>Chalice</h5></td>
					<td><h5>Rites<h5></td>
					<td><h5>Glyph</h5></td>
				</tr>
				<tr>
					<td class="chalice-cell g--4">{{row.1}}</td>
					<td class="rites-cell g--4">{{row.2}}</td>
					<td class="glyph-cell g--4">{{row.3}}</td>						
				</tr>				
			</table>
			<table class="g--12">
				<tr>
					<td class="g--2"><h5>Comments:</h5></td>
					<td class="comments-cell g--10">{{row.12}}</td>
				</tr>
			</table>
			
			<table class="loot-table g--12">
				<tr>
					<td class="g--2"></td>
					<td class="g--5"><h5>Weapons</h5></td>
					<td class="g--5"><h5>Materials</h5></td>
				</tr>
				{% for i in range(0,4) %}
				<tr>
					<td><h5>Layer {{i+1}}</h5></td>
					<td class="weapon-cell">{{row[i+4]}}</td>
					<td class="material-cell">{{row[i+8]}}</td>
				</tr>
				{% endfor %}	
			</table>
		</div>	
	{% endfor %}
	<p>Hello world</p>
	
<script>
$('.chalice-search').on('input', function(){ 
	chalice_search_value = $(this).val().toLowerCase();
	console.log(chalice_search_value);

	$('.chalice-cell').each(function (){
		if ($(this).text().toLowerCase().indexOf(chalice_search_value) < 0){
			$(this).parents('.chalice-entry').hide();
		} else {
			$(this).parents('.chalice-entry').show();
		}
	});	
});

$('.weapon-search').on('input', function(){
	weapon_search_value = $(this).val().toLowerCase();
	console.log(weapon_search_value);

	$('.loot-table').each(function(){
		found_weapon=false;
		$(this).find('.weapon-cell').each(function(){
			if ($(this).text().toLowerCase().indexOf(weapon_search_value) >= 0){	
				found_weapon=true;
			}
		});
		if(found_weapon==true){
			$(this).parents('.chalice-entry').show();
		}else{
			$(this).parents('.chalice-entry').hide();
		}
	});

	$('.comments-cell').each(function(){
		if($(this).text().toLowerCase().indexOf(weapon_search_value) < 0){
			$(this).parents('.chalice-entry').hide();
		}else{
			$(this).parents('.chalice-entry').show();
		}
	});

});

$('.material-search').on('input', function(){
	material_search_value = $(this).val().toLowerCase();
	console.log(material_search_value);

	$('.loot-table').each(function(){
		found_material=false;
		$(this).find('.material-cell').each(function(){
			if ($(this).text().toLowerCase().indexOf(material_search_value) >= 0){	
				found_material=true;
			}
		});
		if(found_material==true){
			$(this).parents('.chalice-entry').show();
		}else{
			$(this).parents('.chalice-entry').hide();
		}
	});
	$('.comments-cell').each(function(){
		if($(this).text().toLowerCase().indexOf(material_search_value) < 0){
			$(this).parents('.chalice-entry').hide();
		}else{
			$(this).parents('.chalice-entry').show();
		}
	});

});
</script>

{% endblock %}